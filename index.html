<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <title>IslamNet | Digital Islamic Suite</title>
    <meta name="title" content="IslamNet | Digital Islamic Suite">
    <meta name="description" content="A premium Islamic dashboard featuring AI chat, Hijri calendar, prayer times, and Quran study tools.">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-actual-link.vercel.app/">
    <meta property="og:title" content="IslamNet | Digital Islamic Suite">
    <meta property="og:description" content="Access Quran, Hadith, and Prayer times in a modern glassmorphism interface.">
    <meta property="og:image" content="Logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&family=Amiri&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --pure-black: #000000;
            --glass-bg: rgba(255, 255, 255, 0.04);
            --glass-border: rgba(255, 255, 255, 0.12);
            --glow-color: rgba(255, 255, 255, 0.8);
        }

        * { box-sizing: border-box; transition: all 0.3s ease; }
        body, html { margin: 0; padding: 0; background: var(--pure-black); color: white; font-family: 'Montserrat', sans-serif; height: 100vh; overflow: hidden; }

        /* STARS */
        .stars-container { position: fixed; width: 100%; height: 100%; z-index: -1; background: var(--pure-black); }
        .star { position: absolute; background: white; border-radius: 50%; animation: glow-pulse var(--d) infinite ease-in-out; box-shadow: 0 0 10px var(--glow-color); }
        @keyframes glow-pulse { 0%, 100% { opacity: 0.3; transform: scale(1); } 50% { opacity: 1; transform: scale(1.4); } }

        /* APP SHELL */
        .app-shell { height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 10px 0; }
        .brand-header { font-weight: 800; font-size: 1.5rem; letter-spacing: -1px; margin-bottom: 10px; text-shadow: 0 0 15px rgba(255,255,255,0.3); }

        /* WINDOW - MOBILE OPTIMIZED HEIGHT */
        .content-window { 
            width: 96%; max-width: 1500px; height: 76vh; 
            background: var(--glass-bg); backdrop-filter: blur(45px); -webkit-backdrop-filter: blur(45px);
            border: 1px solid var(--glass-border); border-radius: 25px; 
            overflow: hidden; position: relative;
        }

        /* VIEW - ADDED PADDING TO FIX OVERLAP */
        .view { 
            display: none; height: 100%; width: 100%; padding: 25px; 
            overflow-y: auto; 
            padding-bottom: 100px; /* Space for the floating nav bar */
        }
        .view.active { display: block; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* PRAYER UI - RESPONSIVE GRID */
        .prayer-header { text-align: center; margin-bottom: 30px; }
        .next-prayer-time { font-size: 3rem; font-weight: 400; margin: 10px 0; letter-spacing: -2px; }
        .prayer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 12px; }
        .p-card { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 20px; text-align: center; border: 1px solid var(--glass-border); }
        .p-card b { display: block; font-size: 1.3rem; margin-top: 8px; }

        /* QUOTE UI */
        .quote-box { background: rgba(255,255,255,0.02); border: 1px solid var(--glass-border); padding: 40px; border-radius: 25px; margin-bottom: 20px; text-align: center; }
        .arabic { font-family: 'Amiri', serif; font-size: 2.2rem; display: block; margin-bottom: 15px; line-height: 1.8; }

        /* CALENDAR UI */
        .calendar-wrap { max-width: 600px; margin: 20px auto; text-align: center; }
        .cal-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
        .cal-day { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.03); border: 1px solid var(--glass-border); border-radius: 12px; font-weight: 600; }
        .cal-day.today { background: white; color: black; box-shadow: 0 0 20px white; }

        /* NAV BAR - MOBILE OPTIMIZED */
        .nav-wrapper { position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); z-index: 1000; width: 92%; max-width: 600px; }
        .tab-bar { 
            background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(25px); 
            border: 1px solid var(--glass-border); border-radius: 50px; 
            padding: 5px; display: flex; gap: 4px;
            overflow-x: auto; scrollbar-width: none;
        }
        .tab-bar::-webkit-scrollbar { display: none; }
        .tab { padding: 12px 18px; border-radius: 40px; cursor: pointer; font-size: 0.6rem; font-weight: 700; color: rgba(255,255,255,0.4); text-transform: uppercase; white-space: nowrap; }
        .tab.active { background: white; color: black; }

        /* CHAT UI */
        #chat-ui { display: flex; flex-direction: column; gap: 15px; padding-bottom: 80px; }
        .msg { padding: 18px; border-radius: 15px; max-width: 85%; border: 1px solid var(--glass-border); background: rgba(255,255,255,0.03); }
        .input-area { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 700px; }
        .input-area input { width: 100%; padding: 16px 25px; border-radius: 40px; background: #000; color: #fff; border: 1px solid var(--glass-border); outline: none; }
        
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>
    <div class="stars-container" id="stars"></div>

    <div class="app-shell">
        <div class="brand-header">ISLAMNET</div>
        
        <div class="content-window">
            <section id="chat-view" class="view active">
                <div id="chat-ui"><div class="msg ai">Bismillah. Ask me anything about Islam.</div></div>
                <div class="input-area"><input type="text" id="userInput" placeholder="Ask anything..." onkeypress="if(event.key==='Enter') startChat()"></div>
            </section>

            <section id="prayer-view" class="view">
                <div class="prayer-header">
                    <p id="city-display" style="opacity:0.6;">Select Location</p>
                    <h1 class="next-prayer-time" id="main-clock">--:--</h1>
                    <div style="display:flex; gap:10px; justify-content:center; margin-bottom:30px; flex-wrap: wrap;">
                        <input type="text" id="cityInput" placeholder="City..." style="background:black; border:1px solid var(--glass-border); color:white; padding:10px; border-radius:10px; width: 120px;">
                        <select id="methodSelect" style="background:black; border:1px solid var(--glass-border); color:white; padding:10px; border-radius:10px;">
                            <option value="2">ISNA</option>
                            <option value="3">MWL</option>
                            <option value="4">Umm al-Qura</option>
                        </select>
                        <button onclick="getPrayers()" style="background:white; color:black; border:none; padding:10px 20px; border-radius:10px; font-weight:700; cursor:pointer;">FIND</button>
                    </div>
                </div>
                <div id="prayer-grid" class="prayer-grid"></div>
            </section>

            <section id="quote-view" class="view">
                <div class="quote-box">
                    <span style="letter-spacing:3px; opacity:0.4; font-size:0.7rem;">DAILY QURAN</span>
                    <span id="q-ar" class="arabic">...</span>
                    <p id="q-en" style="font-style:italic; opacity:0.8;"></p>
                </div>
                <div class="quote-box">
                    <span style="letter-spacing:3px; opacity:0.4; font-size:0.7rem;">DAILY HADITH</span>
                    <p id="h-txt" style="font-size:1.2rem; margin-top:20px;">"Verily, actions are by intentions."</p>
                    <small>- Sahih Bukhari</small>
                </div>
            </section>

            <section id="cal-view" class="view">
                <div class="calendar-wrap">
                    <div class="cal-nav">
                        <button onclick="changeMonth(-1)" style="background:none; border:none; color:white; cursor:pointer; font-size:1.5rem;">←</button>
                        <div>
                            <h2 id="month-name" style="margin:0; font-weight:800;"></h2>
                            <p id="year-name" style="margin:0; opacity:0.5;"></p>
                        </div>
                        <button onclick="changeMonth(1)" style="background:none; border:none; color:white; cursor:pointer; font-size:1.5rem;">→</button>
                    </div>
                    <div class="cal-grid" id="calendar-grid"></div>
                </div>
            </section>

            <section id="quran-view" class="view" style="padding:0;"><iframe src="https://quran.com"></iframe></section>
            <section id="hadith-view" class="view" style="padding:0;"><iframe src="https://sunnah.com"></iframe></section>
            <section id="rec-view" class="view"><h2 style="text-align:center; font-weight:800; margin-top:100px;">AUDIO RECITATIONS: IN PROGRESS</h2></section>
        </div>
    </div>

    <div class="nav-wrapper">
        <div class="tab-bar">
            <div class="tab active" onclick="switchView('chat-view', this)">Chat</div>
            <div class="tab" onclick="switchView('prayer-view', this)">Prayers</div>
            <div class="tab" onclick="switchView('quote-view', this)">Quotes</div>
            <div class="tab" onclick="switchView('cal-view', this)">Calendar</div>
            <div class="tab" onclick="switchView('quran-view', this)">Quran</div>
            <div class="tab" onclick="switchView('hadith-view', this)">Hadith</div>
            <div class="tab" onclick="switchView('rec-view', this)">Audio</div>
        </div>
    </div>

    <script>
        // STARS
        const sc = document.getElementById('stars');
        for(let i=0; i<150; i++) {
            let s = document.createElement('div'); s.className='star';
            s.style.width=s.style.height=Math.random()*3+'px';
            s.style.left=Math.random()*100+'%'; s.style.top=Math.random()*100+'%';
            s.style.setProperty('--d', (Math.random()*4+2)+'s'); sc.appendChild(s);
        }

        // NAV
        function switchView(id, el) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            el.classList.add('active');
            if(id === 'quote-view') loadQuotes();
            if(id === 'cal-view') renderCalendar();
        }

        // PRAYERS
        async function getPrayers() {
            const city = document.getElementById('cityInput').value;
            const method = document.getElementById('methodSelect').value;
            const res = await fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=&method=${method}`);
            const data = await res.json();
            const t = data.data.timings;
            document.getElementById('city-display').innerText = city.toUpperCase();
            document.getElementById('main-clock').innerText = t.Fajr;
            document.getElementById('prayer-grid').innerHTML = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'].map(n => `
                <div class="p-card"><span>${n}</span><b>${t[n]}</b></div>
            `).join('');
        }

        // QUOTES
        async function loadQuotes() {
            const res = await fetch('https://api.alquran.cloud/v1/ayah/random/editions/quran-uthmani,en.sahih');
            const data = await res.json();
            document.getElementById('q-ar').innerText = data.data[0].text;
            document.getElementById('q-en').innerText = data.data[1].text;
        }

        // CALENDAR
        let offset = 0;
        function renderCalendar() {
            const grid = document.getElementById('calendar-grid'); grid.innerHTML = '';
            const target = new Date(); target.setMonth(target.getMonth() + offset);
            const hMonth = new Intl.DateTimeFormat('en-u-ca-islamic-uma', {month:'long'}).format(target);
            const hYear = new Intl.DateTimeFormat('en-u-ca-islamic-uma', {year:'numeric'}).format(target);
            document.getElementById('month-name').innerText = hMonth.toUpperCase();
            document.getElementById('year-name').innerText = hYear;
            for(let i=1; i<=30; i++) {
                const d = document.createElement('div'); d.className = 'cal-day'; d.innerText = i;
                grid.appendChild(d);
            }
        }
        function changeMonth(dir) { offset += dir; renderCalendar(); }

        // CHAT
        async function startChat() {
            const ui = document.getElementById('chat-ui');
            const input = document.getElementById('userInput');
            if(!input.value) return;
            ui.innerHTML += `<div class="msg user">${input.value}</div>`;
            const p = input.value; input.value = "";
            const res = await fetch("/api/ask", { method: "POST", body: JSON.stringify({ prompt: p }) });
            const data = await res.json();
            ui.innerHTML += `<div class="msg ai">${marked.parse(data.choices[0].message.content)}</div>`;
            ui.scrollTop = ui.scrollHeight;
        }
    </script>
</body>
</html>
